/* 03-styles.css — Styles AVANT l'étape 6
   ---------------------------------------------------------------
   - Police unifiée, conteneurs arrondis, UI conforme aux choix validés.
   - Pas de barre d'outils/panneau latéral (étape 6) ici.
*/

/* Base ------------------------------------------------------------------- */
html, body { height: 100%; margin: 0; padding: 0; font-family: Arial, Helvetica, sans-serif; }
#app { position: relative; width: 100%; height: 100%; }
#map { position: absolute; inset: 0; }

/* Panneau Connexion (Étape 5) ------------------------------------------- */
.panel-login { 
  position: absolute; top: 12px; left: 12px; z-index: 1000; 
  max-width: 360px; padding: 8px; border-radius: 12px; 
  background: #eee; border: 2px solid #999; box-shadow: none;
}
#login-form { display: grid; grid-template-columns: 1fr 1fr; grid-auto-rows: auto; gap: 4px; align-items: center; }
#login-email { grid-column: 1 / 2; }
#login-password { grid-column: 2 / 3; }
.panel-login input { height: 30px; border: 1px solid #777; border-radius: 8px; padding: 0 10px; background: #fff; font-weight: 500; }
.panel-login button { height: 30px; border: 1px solid #003cff; border-radius: 8px; background: #003cff; color: #fff; padding: 0 10px; font-weight: 700; cursor: pointer; }
.panel-login button:focus { outline: 2px solid #4da3ff; outline-offset: 2px; }
.login-actions { grid-column: 2 / 3; justify-self: end; display: flex; gap: 6px; }
#login-error { color: #b00020; margin: 6px 0 0 0; }
#login-status { grid-column: 1 / -1; color: #444; }
/* Après connexion : texte + bouton sur une seule ligne, texte sans conteneur */
.panel-login.is-auth #login-form { display: flex; flex-direction: row; align-items: center; gap: 12px; }
.panel-login.is-auth #login-status { background: none; border: none; padding: 0; margin: 0; white-space: nowrap; order: 0; }
.panel-login.is-auth .login-actions { margin-top: 0; display: flex; align-items: center; order: 1; }
.panel-login.is-auth #login-email,
.panel-login.is-auth #login-password,
.panel-login.is-auth #btn-login,
.panel-login.is-auth #login-error { display: none !important; }
.panel-login.is-auth #btn-logout { display: inline-block !important; }

/* Recherche d’adresse (Étape 4) ----------------------------------------- */
.panel-search { 
  position: absolute; top: 12px; right: 12px; z-index: 1000; 
  max-width: 420px; padding: 10px; border-radius: 12px; 
  background: rgba(255,255,255,0.9); box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}
.panel-search form { display: flex; flex-direction: column; gap: 8px; }
.search-row { display: flex; align-items: center; gap: 6px; }
#search-input { flex: 1; height: 38px; padding: 0 10px; border: 1px solid rgba(0,0,0,0.2); border-radius: 8px; }
#search-clear { width: 38px; height: 38px; border-radius: 8px; border: 1px solid rgba(0,0,0,0.2); background: #fff; cursor: pointer; font: 700 18px/36px Arial, Helvetica, sans-serif; }
#search-clear:focus { outline: 2px solid #4da3ff; outline-offset: 2px; }
#search-results { margin: 0; padding: 0; list-style: none; max-height: 240px; overflow: auto; border: 1px solid rgba(0,0,0,0.15); border-radius: 8px; background: #fff; display: none; }
#search-results.show { display: block; }
#search-results li { padding: 8px 10px; cursor: pointer; }
#search-results li:hover, #search-results li[aria-selected="true"] { background: #f2f6ff; }
.help-text { color: #555; font-size: 12px; margin: 0; }

/* Coordonnées (Étape 3) -------------------------------------------------- */
.panel-coords { 
  position: absolute; right: 12px; bottom: 12px; z-index: 1000; 
  padding: 8px 10px; border-radius: 8px; background: rgba(255,255,255,0.9); 
  box-shadow: 0 2px 8px rgba(0,0,0,0.15); font-size: 14px; white-space: nowrap; pointer-events: none;
}

/* Zoom custom (Étape 2) -------------------------------------------------- */
.zoom-right-center { position: absolute; top: 50%; right: 12px; transform: translateY(-50%); z-index: 1000; display: flex; flex-direction: column; gap: 8px; }
.btn-zoom { appearance: none; border: 1px solid rgba(0,0,0,0.2); background: rgba(255,255,255,0.95); border-radius: 8px; width: 40px; height: 40px; font: 700 22px/40px Arial, Helvetica, sans-serif; text-align: center; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.15); user-select: none; }
.btn-zoom:disabled { opacity: 0.5; cursor: not-allowed; }
.btn-zoom:focus { outline: 2px solid #4da3ff; outline-offset: 2px; }
.btn-zoom:hover { filter: brightness(0.97); }

/* Barre d’échelle au-dessus des coordonnées (bas droite) ----------------- */
.leaflet-bottom.leaflet-right .leaflet-control-scale { margin-bottom: 64px; margin-right: 12px; }

/* Étape 6 — visibilité liée à l’authentification */
/* Afficher la barre d’outils seulement si #app a .auth-on (donc utilisateur connecté) */
.toolbar-left { display: none; }               /* masqué par défaut */
#app.auth-on .toolbar-left { display: flex; }  /* visible uniquement connecté */

/* Position/looks de la barre d’outils à gauche */

/*modification de cette section car le bouton apparait même si l'utilisateur n'est pas connecté on ne doit pas garder cette partie
.toolbar-left{
  position:absolute; left:12px; top:96px; z-index:1000;
  display:flex; flex-direction:column; gap:12px;
}
/*modification de cette section car le bouton apparait même si l'utilisateur n'est pas connecté*/
.toolbar-left{
  position:absolute; left:12px; top:96px; z-index:1000;
  /* display contrôlé par l'état d'auth (voir règles ci-dessous) */
  flex-direction:column; gap:12px;
 }
.tool-btn{
  width:48px; height:48px; border:2px solid #999; border-radius:12px; background:#fff;
  box-shadow:0 1px 0 rgba(0,0,0,.2); display:flex; align-items:center; justify-content:center; cursor:pointer;
}
.tool-btn:hover{ filter:brightness(.98); }
.tool-btn:focus{ outline:2px solid #4da3ff; outline-offset:2px; }
.tool-btn[aria-pressed="true"]{ outline:2px solid #4da3ff; }
.tool-icon{ width:28px; height:28px; display:block; }

/* Panneau latéral gauche (masqué tant qu’on ne clique pas sur le bouton) */
.sidepanel{
  position:absolute; left:72px; top:84px; width:320px; max-height:calc(100% - 96px); overflow:auto;
  background:#eee; border:2px solid #999; border-radius:12px; padding:12px; z-index:1000; display:none;
}
.sidepanel.show{ display:block; }
.sidepanel-header{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
.sidepanel-title{ font-weight:600; font-size:18px; }
.panel-close{ border:1px solid #999; background:#fff; width:28px; height:28px; border-radius:6px; cursor:pointer; }

/* Visibilité conditionnée par l'authentification => on interdit l’affichage par défaut (display:none) et on réactive uniquement quand #app porte la classe .auth-on  */
.toolbar-left{ display:none !important; pointer-events:none; }
#app.auth-on .toolbar-left{ display:flex !important; pointer-events:auto; }

/* Supprimer les puces devant les cases du gestionnaire de couches */
.sidepanel .layer-list { 
  list-style: none !important;
  margin: 6px 0 0 0;
  padding-left: 0;
}
.sidepanel .layer-list > li {
  list-style: none !important;
  margin-left: 0;
  padding-left: 0;
}

/* --- Bouton flèche (twisty) pour replier/déplier une couche --- */
.layer-item .twisty{
  width:16px; height:16px; padding:0; margin-right:6px;
  border:none; background:transparent; cursor:pointer;
  display:inline-flex; align-items:center; justify-content:center;
}
.layer-item .twisty::before{
  /* ▶ flèche droite (état replié) */
  content:""; display:block; width:0; height:0;
  border-left:8px solid #111;
  border-top:6px solid transparent; border-bottom:6px solid transparent;
}
.layer-item .twisty[aria-expanded="true"]::before{
  /* ▼ flèche bas (état déplié) */
  border-left:6px solid transparent;
  border-right:6px solid transparent;
  border-top:8px solid #1e66ff; /* bleu maquette */
  border-bottom:none;
}

/* Repli : masque la sous-liste quand la couche est "collapsed" */
.layer-item.collapsed > .layer-sublist { display:none; }

/* Sécurité supplémentaire : retire le marqueur natif s'il persiste pour éviter les puces devant les couches du gestionnaire de couches */
.sidepanel .layer-list > li::marker { content: ''; }

/* Sous-listes d'entités dans le gestionnaire */
.layer-sublist{ list-style:none; margin:6px 0 6px 28px; padding:0; }
.layer-subitem{ display:flex; align-items:center; gap:8px; margin:6px 0; }

/* Swatches pour la sous-liste (icônes à côté des ids) */
.layer-sublist .legend-swatch{
  width:16px; height:16px;
  display:inline-block;
  border:2px solid #555;       /* même style que les autres pastilles */
  border-radius:4px;
  background:#fff;
}
/*intervenant: cercle)*/
.layer-sublist .legend-circle{
  border-radius:50%;           /* rond parfait */
  border:none;                 /* pas de contour pour les intervenants */
}

/* Secteurs intervenants : aplat sans contour */
.layer-sublist .legend-poly-fill{
  border: none !important;        /* pas de bord */
  border-radius: 4px;             /* angles doux comme avant */
  /* la couleur de fond est posée en ligne par le JS (sw.style.background) */
}

/* Secteurs équipes : contour coloré, pas de remplissage */
.layer-sublist .legend-poly-stroke{
  background: transparent !important; /* pas de fond */
  border-style: solid !important;
  border-width: 3px !important;       /* trait visible (comme la maquette) */
  border-radius: 4px;
  /* la couleur du trait est posée en ligne par le JS (sw.style.borderColor) */
}

/* Pastilles supplémentaires pour correspondre aux styles */
.legend-poly-fill{ width:22px; height:14px; border-radius:3px; border:none; background:#999; }
.legend-poly-stroke{ width:22px; height:14px; border:3px solid #333; border-radius:3px; background:transparent; }